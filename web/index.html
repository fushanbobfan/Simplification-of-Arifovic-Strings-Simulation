<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Literal String Coordination Simulation</title>
  <style>
    :root {
      --bg: #f5f7fb;
      --card: #ffffff;
      --ink: #1f2937;
      --muted: #6b7280;
      --line: #e5e7eb;
      --blue: #2563eb;
      --green: #16a34a;
      --orange: #f59e0b;
      --red: #ef4444;
    }
    body { font-family: Arial, sans-serif; margin: 0; background: var(--bg); color: var(--ink); }
    .wrap { max-width: 1200px; margin: 0 auto; padding: 20px; }
    h1 { margin: 0 0 8px; }
    .subtitle { margin: 0 0 18px; color: var(--muted); }
    .grid { display: grid; grid-template-columns: 340px 1fr; gap: 16px; }
    .card { background: var(--card); border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,.08); padding: 14px; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
    label { display: block; font-size: 13px; margin-top: 8px; }
    input, select { width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 8px; }
    button { border: 0; border-radius: 10px; cursor: pointer; padding: 10px 12px; font-weight: 600; }
    .primary { background: var(--blue); color: #fff; }
    .primary:hover { background: #1d4ed8; }
    .ghost { background: #e5e7eb; }
    .scenario { display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; margin-top: 8px; }
    .scenario button.active { background: var(--blue); color: #fff; }
    .legend { font-size: 12px; color: var(--muted); margin-top: 8px; }
    .stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 10px; }
    .stat { border: 1px solid var(--line); border-radius: 10px; padding: 8px; }
    .k { font-size: 11px; color: var(--muted); }
    .v { font-size: 18px; font-weight: 700; }
    .viz { border: 1px solid var(--line); border-radius: 10px; min-height: 280px; padding: 8px; background: #fcfcff; }
    .agent {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #374151;
      border-radius: 999px;
      margin: 4px;
      height: 18px;
      font-size: 10px;
      font-weight: bold;
      color: #111827;
      background: #fff;
      box-sizing: border-box;
    }
    .agent.low { width: 24px; background: #fde68a; }
    .agent.medium { width: 40px; background: #86efac; }
    .agent.high { width: 60px; background: #93c5fd; }
    .tableWrap { max-height: 300px; overflow: auto; border: 1px solid var(--line); border-radius: 10px; margin-top: 10px; }
    table { width: 100%; border-collapse: collapse; font-size: 13px; }
    th, td { padding: 7px; border-bottom: 1px solid var(--line); text-align: left; }
    th { position: sticky; top: 0; background: #fff; }
    .small { font-size: 12px; color: var(--muted); }
    @media (max-width: 980px) {
      .grid { grid-template-columns: 1fr; }
      .scenario { grid-template-columns: repeat(2, 1fr); }
      .stats { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Literal String Coordination Simulation</h1>
    <p class="subtitle">"String" means literal string length (short/medium/long), mapped to effort (L/M/H) in a minimum-effort coordination game.</p>

    <div class="grid">
      <section class="card">
        <h3>Game setup</h3>
        <div class="scenario">
          <button class="ghost active" data-group-size="2">n = 2</button>
          <button class="ghost" data-group-size="4">n = 4</button>
          <button class="ghost" data-group-size="15">n = 15</button>
          <button class="ghost" data-group-size="all">Whole class</button>
        </div>

        <label>Class size (agents)</label>
        <input id="populationSize" type="number" min="4" value="60" />

        <div class="row">
          <div>
            <label>Rounds</label>
            <input id="rounds" type="number" min="1" value="40" />
          </div>
          <div>
            <label>Seed</label>
            <input id="seed" type="number" value="42" />
          </div>
        </div>

        <label>Learning rate (0-1)</label>
        <input id="learningRate" type="number" min="0" max="1" step="0.01" value="0.25" />

        <div class="row" style="margin-top:10px;">
          <button id="runButton" class="primary">Run simulation</button>
          <button id="nextRoundButton" class="ghost">Step +1 round</button>
        </div>

        <p class="legend">
          Effort mapping: <b>L</b> = short string (cost 0), <b>M</b> = medium string (cost 5), <b>H</b> = long string (cost 10).<br />
          Group benefit depends on <b>minimum effort</b>: L→0, M→10, H→100.
        </p>
      </section>

      <section class="card">
        <h3>Visualization</h3>
        <div class="stats">
          <div class="stat"><div class="k">Current scenario</div><div class="v" id="scenarioLabel">n=2</div></div>
          <div class="stat"><div class="k">Round</div><div class="v" id="roundLabel">0</div></div>
          <div class="stat"><div class="k">Avg payoff</div><div class="v" id="avgPayoffLabel">0.00</div></div>
          <div class="stat"><div class="k">Min effort in class</div><div class="v" id="classMinLabel">L</div></div>
        </div>

        <div class="viz" id="viz"></div>
        <p class="small">Each capsule is a literal string. Short/medium/long length represents chosen effort level.</p>

        <div class="tableWrap">
          <table>
            <thead>
              <tr>
                <th>Round</th>
                <th>Share L</th>
                <th>Share M</th>
                <th>Share H</th>
                <th>Avg payoff</th>
              </tr>
            </thead>
            <tbody id="historyBody"></tbody>
          </table>
        </div>
      </section>
    </div>
  </div>
  <script src="app.js"></script>
</body>
</html>
